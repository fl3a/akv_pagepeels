<?php
// $Id$
/**
 * @file
 * Displays a pagepeel for the german movement against "Vorratsdatenspeicherung", www.vorratsdatenspeicherung.de
 * HTML/CSS coding by www.dataloo.de (Schrift/Abbildung: Parole von www.dataloo.de)
 */

/**
 * Display help and module information
 * @param section which section of the site we're displaying help
 * @return help text for section
 */
function akv_pagepeels_help($section='') {
  
$output = '';

  switch ($section) {
    case "admin/help#akv_pagepeels":
      $output = '<p>'.  t("Administer pagepage under ..."). '</p>';
      break;
  }
  return $output;
}

/**
 *
 */
function akv_pagepeels_perm() {
  return array('administer akv_pagepeels');
}


/**
 *
 */
function akv_pagepeels_admin(){

  $form['akv_activated'] = array (    
    '#type' => 'fieldset',
    '#title' => t('Visibility'),
    '#weight' => 0,
    '#collapsible' => FALSE,
  );
  $form['akv_activated']['state'] = array (
    '#type' => 'radios',
    '#default_value' => variable_get('akv_activated','off'),
    '#options' => array(
      'on' => t('on'),
      'off' => t('off')
      ),
    '#required' => TRUE,
  );
  $form['akv_type'] = array (    
    '#type' => 'fieldset',
    '#title' => t('Pagepeel type'),
    '#weight' => 0,
    '#collapsible' => FALSE,
  );
  $form['akv_type']['type'] = array (
    '#type' => 'radios',
    '#default_value' => variable_get('akv_type','ani_cam'),
    '#options' => array(
      'schaeuble' => t('Schäuble, Interior Minister of germany'),
      'cam' => t('surveilance camera'),
      'ani_cam' => t('Animated surveilance camera'),
    )
  );
  return system_settings_form($form);
}

/**
 *
 */
function akv_pagepeels_admin_submit($form_id, $form_values) {
 if($form_values['op'] == t('Save configuration')){
    variable_set('akv_activated', $form_values['state']);
    variable_set('akv_type', $form_values['type']);
    switch($form_values['type']) {
	case()
	  break;
    }
    drupal_set_message(t('The configuration options have been saved.'));

  }
  else { 
    variable_del('akv_activated');
    variable_del('akv_type');
    drupal_set_message(t('The configuration options have been resetted.'));
  }
}
/**
* Implementation of hook_menu().
*/
function akv_pagepeels_menu() {

  $items = array();

  $items[] = array(
    'path' => 'admin/settings/akv_pagepeels',
    'title' => t('AKV pagepeel module settings'),
    'description' => t('Settings for AKV Pagepeel'),
    'callback' => 'drupal_get_form',
    'callback arguments' => 'akv_pagepeels_admin',
    'access' => user_access('administer akv_pagepeels'),
    'type' => MENU_NORMAL_ITEM,
  );
  return $items;
}
/**
 *
 */
function akv_pagepeels_footer($main = 0) {
  if(variable_get('akv_activated','') == 'on') {
    drupal_add_css(drupal_get_path('module', 'akv_pagepeels') .'/akv_pagepeels_'. variable_get('akv_type','') .'.css');
    return '
      <!-- AKV-Animated body start v1.0 -->
        <div id="akct">
          <a id="akpeel" href="http://www.vorratsdatenspeicherung.de/aktuell" target="_blank" title="Stoppt den Überwachungsstaat! Jetzt klicken & handeln!">
            <img src="http://wiki.vorratsdatenspeicherung.de/images/Akvst.gif" alt="Stoppt den Überwachungsstaat! Jetzt klicken & handeln" />
          </a>
          <a id="akpreload" href="http://wiki.vorratsdatenspeicherung.de/?title=Online-Demo" target="_blank" title="Willst du auch an der Aktion teilnehmen? Hier findest du alle relevanten Infos und Materialien:">
            <img src="http://wiki.vorratsdatenspeicherung.de/images/Akvsi.gif" alt="Willst du auch an der Aktion teilnehmen? Hier findest du alle relevanten Infos und Materialien:" />
          </a>
        </div>
      <!-- AKV body end -->';
  }
  else {
    return;
  }
}

/**
* Generate HTML for AKV Pagepeels
* @param op the operation from the URL
* @param delta offset
* @returns block HTML
*/
function akv_pagepeels_block($op='list', $delta=0) {

  if ($op == "list") {
    $block[0]["info"] = t("AKV Block");
    return $block;
  }
  else if ($op == 'view') {
    $block_content = '
      <div id="akct">
        <a id="akpeel" href="http://www.vorratsdatenspeicherung.de/aktuell" target="_blank" title="Stoppt den Überwachungsstaat! Jetzt klicken & handeln!">
          <img src="http://wiki.vorratsdatenspeicherung.de/images/Akvst.gif" alt="Stoppt den Überwachungsstaat! Jetzt klicken & handeln" />
        </a>
        <a id="akpreload" href="http://wiki.vorratsdatenspeicherung.de/?title=Online-Demo" target="_blank" title="Willst du auch an der Aktion teilnehmen? Hier findest du alle relevanten Infos und Materialien:">
          <img src="http://wiki.vorratsdatenspeicherung.de/images/Akvsi.gif"alt="Willst du auch an der Aktion teilnehmen? Hier findest du alle relevanten Infos und Materialien:" />
        </a>
      </div>';
    $block['subject'] = t('AKV Block');
    $block['content'] = $block_content;
    drupal_add_css(drupal_get_path('module', 'akv_pagepeels') .'/akv_pagepeels_'. variable_get('akv_type','') .'.css');
    return $block;
  }
}


